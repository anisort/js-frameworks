<section class="task-list-container">
  <div class="task-header">
    <h2>List of tasks</h2>
    <button mat-raised-button (click)="openDialog()">Add new task</button>
  </div>
  <mat-form-field>
    <mat-label>Filter by status</mat-label>
    <mat-select (selectionChange)="onSelected($event)" [formControl]="statusControl">
      <mat-option [value]="''">All</mat-option>
      <mat-option [value]="TaskStatus.TODO">To do</mat-option>
      <mat-option [value]="TaskStatus.IN_PROGRESS">In progress</mat-option>
      <mat-option [value]="TaskStatus.DONE">Done</mat-option>
    </mat-select>
  </mat-form-field>
  <mat-form-field>
    <mat-label>Search (name, description, assignee)</mat-label>
    <input matInput type="text" id="filter" [formControl]="filterControl">
  </mat-form-field>
  @if (hasLoading) {
    <div class="spinner-container">
      <mat-spinner></mat-spinner>
    </div>
  } @else {
    @if(tasks$ | async; as tasks) {
      <table mat-table [dataSource]="tasks" class="mat-elevation-z2">
        <!-- Назва -->
        <ng-container matColumnDef="title">
          <th mat-header-cell *matHeaderCellDef> Title </th>
          <td mat-cell *matCellDef="let task"> {{ task.title }} </td>
        </ng-container>
        <ng-container matColumnDef="description">
          <th mat-header-cell *matHeaderCellDef> Description </th>
          <td mat-cell *matCellDef="let task"> {{ task.description }} </td>
        </ng-container>
        <!-- Виконавець -->
        <ng-container matColumnDef="assignee">
          <th mat-header-cell *matHeaderCellDef> Assignee </th>
          <td mat-cell *matCellDef="let task"> {{ task.assignee }} </td>
        </ng-container>
        <!-- Дата -->
        <ng-container matColumnDef="dueDate">
          <th mat-header-cell *matHeaderCellDef> Due date </th>
          <td mat-cell *matCellDef="let task"> {{ task.dueDate }} </td>
        </ng-container>
        <!-- Статус -->
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef> Status </th>
          <td mat-cell *matCellDef="let task"> {{ task.status | taskStatus}} </td>
        </ng-container>
        <!-- Дії -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef> Actions </th>
          <td mat-cell *matCellDef="let task">
            <button mat-button (click)="viewTask(task.id)">View</button>
            <button mat-button (click)="editTask(task.id)">Edit</button>
            <button mat-button color="warn" (click)="deleteTask(task.id)">Delete</button>
          </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    }
  '
  }
  <mat-paginator #paginator [pageSize]="5" [pageSizeOptions]="[1, 5, 10, 25]" [length]="totalTasks$ | async"></mat-paginator>
</section>
